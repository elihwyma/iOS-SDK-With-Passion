/*
 Image: /System/Library/PrivateFrameworks/Celestial.framework/Celestial
 */

#import <Celestial/BWNode.h>

@class BWPixelBufferPool, BWRamp, BWSpringSimulation, CIContext, FigCaptureMachPortSendRight, NSData, NSMutableDictionary, NSObject, NSString;

@protocol BWPreviewStitcherDelegate, OS_dispatch_group, OS_dispatch_queue;

@interface BWPreviewStitcherNode : BWNode

{
    CDStruct_79c71658 _outputDimensions;
    double _primaryCaptureRectYInset;
    int _primaryCaptureRectPixelInset;
    double _primaryCaptureRectCenterX;
    int _primaryCaptureRectCenterXPixelOffset;
    int _primaryCaptureRectCenterXPixelOffsetFudge;
    _Bool _previewsWideBeforeSlaveStreamStarts;
    NSData *_superWideCameraViewMatrix;
    NSData *_telephotoCameraViewMatrix;
    struct CGPoint _superWideOpticalCenterOffset;
    struct CGPoint _wideOpticalCenterOffset;
    struct CGPoint _teleOpticalCenterOffset;
    float _superWidePixelsPerMicron;
    float _widePixelsPerMicron;
    float _telePixelsPerMicron;
    float _superWideBaseZoomFactor;
    float _wideBaseZoomFactor;
    float _teleBaseZoomFactor;
    float _superWideCorrectedBaseZoomFactor;
    float _wideBaseZoomFactorOverride;
    _Bool _wideBaseZoomFactorDynamicOverrideEnabled;
    float _wideBaseZoomFactorDynamicOverride;
    float _wideBaseZoomFactorDynamicOverrideScaled;
    float _wideBaseZoomFactorOverrideMacro;
    float _widePinholeFocalLengthInfinity;
    float _widePinholeFocalLengthMacro;
    float _dynamicWideBaseZoomFactorSmoothingFactor;
    float _teleBaseZoomFactorOverride;
    CDStruct_79c71658 _sensorBinningFactor;
    unsigned int _bravoShiftCorrectionFlags;
    CDStruct_c6494e1c _superWideToWideShiftState;
    CDStruct_c6494e1c _wideToTeleShiftState;
    float _shiftSmoothingFactor;
    _Bool _applyShift;
    struct CGPoint _superWideToWideBravoShift;
    struct CGPoint _wideToTeleBravoShift;
    struct OpaqueVTImageRotationSession *_rotationSession;
    struct opaqueCMFormatDescription *_outputFormatDescription;
    id <BWPreviewStitcherDelegate> _delegate;
    _Bool _stoppingForModeSwitch;
    struct os_unfair_lock_s _configurationLock;
    _Bool _deviceIsStationary;
    _Bool _pendingRegistrationAfterDeviceBecomesStationary;
    _Bool _registrationEnabled;
    int _lastRegisteredFrameCaptureID;
    _Bool _lastRegistrationEnabled;
    NSObject<OS_dispatch_queue> *_registrationQueue;
    struct os_unfair_lock_s _shiftCorrectionsUpdateLock;
    struct BWPreviewStitcherShiftCorrection _wideToTeleShiftCorrections[3];
    struct BWPreviewStitcherShiftCorrection _superWideToWideShiftCorrections[3];
    BWPixelBufferPool *_registrationPool;
    struct OpaqueVTImageRotationSession *_registrationRotationSession;
    int _registrationFrameSkipCount;
    int _registrationUpdateRampFrameCount;
    _Bool _registerFirstFrame;
    double _primaryCameraAspectRatio;
    float _lastPrimaryCameraAspectRatio;
    FigCaptureMachPortSendRight *_fencePortSendRight;
    long long _fencePortGenerationCount;
    _Bool _displaysWidestCameraOnly;
    _Bool _displaysPrimaryCameraOnly;
    _Bool _drawWiderCameraOnly;
    _Bool _currentZoomRequiresWiderCamera;
    _Bool _lastZoomingOrSwitchingCameras;
    float _rampZoomFactorOfInterest;
    float _rampStartZoomFactor;
    NSString *_lastRecommendedMasterPortType;
    NSString *_lastNarrowerPortType;
    _Bool _lastNarrowerCameraIsTele;
    BWRamp *_teleOpacityRamp;
    BWPixelBufferPool *_teleOpacityPool;
    CDStruct_79c71658 _teleOpacityPoolDimensions;
    CIContext *_teleOpacityCIContext;
    int _screenScale;
    _Bool _frameRateBasedRampsEnabled;
    NSObject<OS_dispatch_queue> *_ciPreheatingQueue;
    NSObject<OS_dispatch_group> *_ciPreheatingGroup;
    _Bool _havePreheatedCI;
    CDStruct_1b6d18a9 _firstFramePTS;
    _Bool _edgeFeatheringEnabled;
    _Bool _showFeatherGradient;
    float _edgeFeatheringAspectCompensation;
    float _zoomInFeatheringInnerRadiusStart;
    float _zoomInFeatheringInnerRadiusEnd;
    float _zoomInFeatheringOuterRadiusStart;
    float _zoomInFeatheringOuterRadiusEnd;
    float _zoomOutFeatheringInnerRadiusStart;
    float _zoomOutFeatheringInnerRadiusEnd;
    float _zoomOutFeatheringOuterRadiusStart;
    float _zoomOutFeatheringOuterRadiusEnd;
    _Bool _featherEdgesForOpacityRamp;
    struct opaqueCMSampleBuffer *_lastSampleBuffer;
    CDStruct_1b6d18a9 _lastRenderedPTS;
    _Bool _multiCameraStitchingEnabled;
    _Bool _aspectRatioChanging;
    long long _lastRenderTime;
    float _additionalZoomFactor;
    float _additionalZoomFactorSpringStartFactor;
    CDStruct_1b6d18a9 _additionalZoomFactorSpringStartPTS;
    BWSpringSimulation *_additionalZoomFactorSpring;
    NSMutableDictionary *_blackFilledBorderRectsBySurfaceID;
    int _overCaptureStatus;
    struct BWSmartCameraScene _wideFocusDistanceFarEnoughForStitching;
    _Bool _hideSuperWideOverCaptureWhenTooClose;
    _Bool _superWideOccludedByWide;
    _Bool _superWideDrawingSuspendedUntilFocusImproves;
    _Bool _hideSuperWideStitchingWhenTooClose;
    _Bool _hidePartialOverCapture;
    _Bool _deviceTooHotDimmingEnabled;
    int _wideFallbackMode;
    struct BWSmartCameraScene _wideFocusDistanceFarEnoughToUseTele;
    _Bool _wideFocusingOneShot;
    _Bool _teleFocusingOneShot;
    BWRamp *_wideFallbackShiftRamp;
    struct CGPoint _wideFallbackRecenteringShiftOffset;
    _Bool _wantWideFallbackDueToTeleAEAF;
    _Bool _wideFallbackShiftRampTargetValueIsWide;
}

@property (nonatomic) id <BWPreviewStitcherDelegate> delegate;
@property _Bool displaysWidestCameraOnly;
@property (nonatomic) _Bool stoppingForModeSwitch;

+ (void)initialize;

- (void)dealloc;
- (id)nodeType;
- (void)configurationWithID:(long long)arg1 updatedFormat:(id)arg2 didBecomeLiveForInput:(id)arg3;
- (void)didReachEndOfDataForInput:(id)arg1;
- (id)nodeSubType;
- (void)renderSampleBuffer:(struct opaqueCMSampleBuffer *)arg1 forInput:(id)arg2;
- (void)didSelectFormat:(id)arg1 forInput:(id)arg2;
- (void)prepareForCurrentConfigurationToBecomeLive;
- (void)setOutputDimensions:(CDStruct_79c71658)arg1;
- (CDStruct_79c71658)outputDimensions;
- (id)initWithCameraInfoByPortType:(id)arg1 sensorBinningFactor:(CDStruct_79c71658)arg2;
- (void)_restitchAndEmitLastInputForAspectAndCenterChange;
- (_Bool)_displaysPrimaryCameraOnly;
- (float)_wideBaseZoomFactorWithOverrideLocked;
- (float)wideFocusDistance;
- (id)_primaryCameraPortType;
- (float)_wideFallbackRecenteringStrength;
- (void)_preheatCIRenderingAsync;
- (_Bool)_updateZoomStatusFromWideSampleBuffer:(struct opaqueCMSampleBuffer *)arg1 teleSampleBuffer:(struct opaqueCMSampleBuffer *)arg2;
- (struct CGPoint)_computeBravoWideToTeleShiftFromWideSampleBuffer:(struct opaqueCMSampleBuffer *)arg1 teleSampleBuffer:(struct opaqueCMSampleBuffer *)arg2;
- (_Bool)_currentlyZoomingOrSwitchingCameras;
- (void)_updateShiftCorrectionsAsyncFromComputedShift:(struct CGPoint)arg1 byRegisteringWide:(struct opaqueCMSampleBuffer *)arg2 tele:(struct opaqueCMSampleBuffer *)arg3 centerBias:(_Bool)arg4;
- (void)_updateAndGetWideRegionShifts:(struct CGPoint *)arg1 teleShift:(struct CGPoint *)arg2 wideIsSuperWide:(_Bool)arg3 forComputedShift:(struct CGPoint)arg4 registrationEnabled:(_Bool)arg5 currentFrameRate:(float)arg6;
- (void)_updateOverCaptureStatusWithWiderSampleBuffer:(struct opaqueCMSampleBuffer *)arg1 narrowerSampleBuffer:(struct opaqueCMSampleBuffer *)arg2;
- (struct opaqueCMSampleBuffer *)_newStitchedSampleBufferFromWide:(struct opaqueCMSampleBuffer *)arg1 tele:(struct opaqueCMSampleBuffer *)arg2 wideRegionsShifts:(struct CGPoint *)arg3 teleShift:(struct CGPoint)arg4 primaryCaptureRectOut:(struct CGRect *)arg5 primaryCaptureRectBeforeCroppingOut:(struct CGRect *)arg6;
- (void)_setOverCaptureStatus:(int)arg1;
- (void)_waitForCIPreheatingToFinish;
- (float)_wideBaseZoomFactorWithOverride;
- (_Bool)_currentlyRampingZoom;
- (_Bool)_currentlySwitchingCameras;
- (float)_teleBaseZoomFactorWithOverride;
- (_Bool)_haveSuperWideCamera;
- (void)_getInputRect:(struct CGRect *)arg1 outputRect:(struct CGRect *)arg2 inputShiftAppliedInOutputRect:(struct CGPoint *)arg3 toTransferPixelBuffer:(struct __CVBuffer *)arg4 rect:(struct CGRect)arg5 intoPixelBuffer:(struct __CVBuffer *)arg6 rect:(struct CGRect)arg7 withInputShift:(struct CGPoint)arg8 shiftOutsideBoundingRectAllowed:(_Bool)arg9 scale:(float)arg10;
- (struct CGRect)_transferPixelBuffer:(struct __CVBuffer *)arg1 rect:(struct CGRect)arg2 intoPixelBuffer:(struct __CVBuffer *)arg3 rect:(struct CGRect)arg4 withInputShift:(struct CGPoint)arg5 scale:(float)arg6 inputSourceRectOut:(struct CGRect *)arg7;
- (id)_teleOpacityPool;
- (void)_renderOpacityRampToPixelBuffer:(struct __CVBuffer *)arg1 bounds:(struct CGRect)arg2 withWidePixelBuffer:(struct __CVBuffer *)arg3 telePixelBuffer:(struct __CVBuffer *)arg4 zoomingIn:(_Bool)arg5 progress:(float)arg6;
- (float)_scaleFactorAppliedForPixelBuffer:(struct __CVBuffer *)arg1 usedSourceRect:(struct CGRect)arg2 primaryCaptureRectAspectRatio:(double)arg3 metadata:(id)arg4;
- (void)_callDelegateWithAppliedWiderShift:(struct CGPoint)arg1 narrowerShift:(struct CGPoint)arg2 widerScaleFactor:(float)arg3 narrowerScaleFactor:(float)arg4 widerPixelBuffer:(struct __CVBuffer *)arg5 narrowerPixelBuffer:(struct __CVBuffer *)arg6 widerPortType:(id)arg7 narrowerPortType:(id)arg8;
- (_Bool)_haveTeleCamera;
- (_Bool)_currentlyRunningShortZoomRampOrNotRampingZoom;
- (id)overCaptureStatusString;
- (int)_cameraDisplayTransitionFrameCountForCameraFallbackChange:(_Bool)arg1 currentFrameRate:(float)arg2;
- (int)_wideFallbackShiftRampFrameCount;
- (int)_scale30FPSFrameCount:(int)arg1 toFrameRate:(float)arg2;
- (int)_zoomOutOpacityRampFrameCount;
- (int)_zoomInOpacityRampFrameCount;
- (int)_wideFallbackOpacityRampFrameCount;
- (_Bool)_haveSuperBravo;
- (struct CGPoint)_shiftCorrectionForComputedShift:(struct CGPoint)arg1 forLeftStrip:(_Bool)arg2 byRegisteringWide:(struct opaqueCMSampleBuffer *)arg3 tele:(struct opaqueCMSampleBuffer *)arg4 centerBias:(_Bool)arg5 err:(int *)arg6;
- (id)initWithStitchingDisabled;
- (void)setPrimaryCaptureRectAspectRatio:(double)arg1 center:(struct CGPoint)arg2 fencePortSendRight:(id)arg3;
- (void)rampToAdditionalZoomFactor:(double)arg1;
- (void)setPrimaryCameraAspectRatio:(double)arg1;
- (double)primaryCameraAspectRatio;
- (void)setPrimaryCaptureRectYInset:(double)arg1;
- (double)primaryCaptureRectYInset;
- (void)setPrimaryCaptureRectCenterX:(double)arg1;
- (double)primaryCaptureRectCenterX;
- (void)setPreviewsWideBeforeSlaveStreamStarts:(_Bool)arg1;
- (_Bool)previewsWideBeforeSlaveStreamStarts;
- (float)wideBaseZoomFactor;
- (id)focusingDescription;
- (id)primaryCameraShortDisplayName;
- (_Bool)tooCloseFor1xStitching;
- (_Bool)centerRegistrationValid;
- (id)wideFallbackDescription;

@end
