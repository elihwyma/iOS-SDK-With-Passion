/*
 Image: /System/Library/Frameworks/PencilKit.framework/PencilKit
 */

#import <Foundation/NSObject.h>

@class CIContext, MISSING_TYPE, PKLinedPaper, PKMetalFramebuffer, PKMetalRenderState, PKMetalResourceHandler, PKMetalShader;

@protocol MTLBuffer, MTLCommandQueue, MTLCommandQueueSPI, MTLDevice, MTLTexture;

@interface PKMetalRenderer : NSObject

{
    PKMetalRenderState *_currentRenderState;
    unsigned long long _currentCacheSize;
    id <MTLDevice> _device;
    id <MTLCommandQueueSPI> _commandQueue;
    PKMetalFramebuffer *_originalBackFramebuffer;
    _Bool _shouldClearOriginalBackFramebuffer;
    PKMetalFramebuffer *_paintFramebuffer;
    PKMetalFramebuffer *_alwaysMemorylessPaintFramebuffer;
    PKMetalFramebuffer *_paintFramebufferAccumulator;
    PKMetalFramebuffer *_maskMSAAFramebuffer;
    PKMetalResourceHandler *_resourceHandler;
    PKMetalFramebuffer *_dummyPaintFramebuffer;
    PKMetalFramebuffer *_dummyColorFramebuffer;
    struct CGSize _drawingPixelSize;
    struct CGColor *_backgroundColor;
    struct CGSize _actualSize;
    double _fromStrokeSpaceScale;
    struct CGAffineTransform _strokeTransform;
    struct CGRect _viewScissor;
    _Bool _lastPointForEraserIsValid;
    struct _PKStrokePoint _lastPointForEraser;
    struct vector<(anonymous namespace)::StrokeVertex, std::__1::allocator<(anonymous namespace)::StrokeVertex>> _strokeBuffer;
    unsigned long long _strokeBufferCount;
    CIContext *_coreImageContext;
    id <MTLTexture> _paperTexture;
    struct CGSize _paperTextureSize;
    unsigned long long _pixelFormat;
    unsigned long long _paintAndParticlePixelFormat;
    struct vector<PKMetalParticleStrokePoint, std::__1::allocator<PKMetalParticleStrokePoint>> _particleStrokePointBuffer;
    struct vector<PKMetalPaintStrokePoint, std::__1::allocator<PKMetalPaintStrokePoint>> _paintStrokePointBuffer;
    struct vector<PKMetalLiveStrokePaintStrokePoint, std::__1::allocator<PKMetalLiveStrokePaintStrokePoint>> _liveStrokeStrokePointBuffer;
    struct vector<(anonymous namespace)::AnimatingStroke, std::__1::allocator<(anonymous namespace)::AnimatingStroke>> _animatingStrokes;
    struct CGRect _paintFramebufferDirtyRect;
    PKMetalShader *_paintShader;
    PKMetalShader *_particleShader;
    PKMetalShader *_particleShaderWithAspectRatioSupport;
    id <MTLBuffer> _particleIndexBuffer;
    id <MTLBuffer> _randomNumberBuffer;
    unsigned long long _renderMaskMSAASampleCount;
    _Bool _needRestartWorkaroundForOldIntelDrivers;
    _Bool _useComputeRenderCaches;
    _Bool _solidColorBackboard;
    _Bool _oneRenderPassForLiveRendering;
    _Bool _liveStrokeMode;
    _Bool _invertColors;
    PKLinedPaper *_linedPaper;
    struct CGColor *_liveRenderingOverrideColor;
    double _backboardPaperMultiply;
    double _inputScale;
    double _eraserIndicatorAlpha;
    double _liveStrokeElapsedTime;
    double _liveStrokeDuration;
    struct CGAffineTransform _paperTransform;
}

@property (nonatomic, readonly) id <MTLCommandQueue> commandQueue;
@property (nonatomic, readonly) id <MTLDevice> device;
@property (retain, nonatomic) PKLinedPaper *linedPaper;
@property (nonatomic) struct CGAffineTransform paperTransform;
@property (nonatomic) struct CGColor *backgroundColor;
@property (nonatomic) struct CGColor *liveRenderingOverrideColor;
@property (nonatomic) _Bool solidColorBackboard;
@property (nonatomic) _Bool oneRenderPassForLiveRendering;
@property (nonatomic) struct CGRect viewScissor;
@property (nonatomic) struct CGAffineTransform strokeTransform;
@property (nonatomic) struct CGSize actualSize;
@property (nonatomic) double backboardPaperMultiply;
@property (nonatomic, readonly) PKMetalResourceHandler *resourceHandler;
@property (nonatomic) double inputScale;
@property (nonatomic) double eraserIndicatorAlpha;
@property (nonatomic) _Bool liveStrokeMode;
@property (nonatomic) double liveStrokeElapsedTime;
@property (nonatomic) double liveStrokeDuration;
@property (nonatomic, readonly) _Bool isFinishedRendering;
@property (nonatomic, readonly) double latestTimestamp;
@property (nonatomic) _Bool invertColors;

+ (_Bool)useBlitEncoder;

- (void)dealloc;
- (void)clear;
- (id).cxx_construct;
- (void)setup;
- (struct CGImage *)newCGImage;
- (void)flushMemoryIfPossible;
- (void)setPaperTextureImage:(struct CGImage *)arg1;
- (void)purgeOriginalBackFramebuffer;
- (void)drawingBeganWithStroke:(id)arg1;
- (void)drawingEnded:(id)arg1 finishStrokeBlock:(CDUnknownBlockType)arg2;
- (void)drawingCancelled;
- (id)initWithDrawingPixelSize:(struct CGSize)arg1 actualSize:(struct CGSize)arg2 device:(id)arg3 resourceHandler:(id)arg4;
- (struct CGImage *)newCGImageWithClipRect:(struct CGRect)arg1;
- (void)buildRenderCacheForStrokes:(id)arg1;
- (unsigned long long)clearAndRenderStrokes:(id)arg1 clippedToStrokeSpaceRect:(struct CGRect)arg2 strokeTransform:(struct CGAffineTransform)arg3 stopBlock:(CDUnknownBlockType)arg4;
- (void)generateLiveStrokeCachesForStrokes:(id)arg1 destinationLocations:(const vector_9d39b153 *)arg2 strokeInterval:(float)arg3 liveStrokeFrame:(struct CGRect)arg4 liveStrokeTexture:(id)arg5;
- (void)clearTile:(id)arg1 waitUntilCompleted:(_Bool)arg2;
- (void)setShouldClearOriginalFramebuffer;
- (void)copyIntoTile:(id)arg1 tileTransform:(struct CGAffineTransform)arg2 waitUntilCompleted:(_Bool)arg3;
- (void)clearAndRenderTiles:(id)arg1 tileTransform:(struct CGAffineTransform)arg2 waitUntilCompleted:(_Bool)arg3;
- (void)renderTiles:(id)arg1 intoTile:(id)arg2 waitUntilCompleted:(_Bool)arg3;
- (void)renderTexture:(id)arg1;
- (void)renderImage:(struct CGImage *)arg1 andMask:(struct CGImage *)arg2;
- (void)renderImage:(struct CGImage *)arg1 andMask:(struct CGImage *)arg2 clippedToStrokeSpaceRect:(struct CGRect)arg3;
- (unsigned long long)renderStrokes:(id)arg1 clippedToStrokeSpaceRect:(struct CGRect)arg2 strokeTransform:(struct CGAffineTransform)arg3 stopBlock:(CDUnknownBlockType)arg4;
- (unsigned long long)renderStrokes:(id)arg1 stopBlock:(CDUnknownBlockType)arg2;
- (void)getAndRenderNewPoints:(id)arg1;
- (void)renderAheadWithTransform:(struct CGAffineTransform)arg1 onPaper:(_Bool)arg2 renderBufferSize:(struct CGSize)arg3 destinationTexture:(id)arg4;
- (void)finishLiveStrokeAndPresentDrawable:(id)arg1 waitUntilScheduled:(_Bool)arg2;
- (void)renderLiveStrokeWithTransform:(struct CGAffineTransform)arg1 renderBufferSize:(struct CGSize)arg2;
- (double)alphaForStroke:(id)arg1;
- (id)CIImageFromTexture:(id)arg1;
- (void)teardownDrawingFramebuffers;
- (void)drawNewPointsAt:(double)arg1;
- (void)clearPaintFramebuffers;
- (unsigned long long)renderStroke:(struct _PKStrokePointSlice)arg1 animatingStroke:(struct AnimatingStroke *)arg2 accumulating:(_Bool)arg3 combinedRendering:(_Bool)arg4 renderEncoder:(id)arg5 computeEncoder:(id)arg6 renderCache:(id)arg7;
- (_Bool)applyStrokeSpaceClipRect:(struct CGRect)arg1 strokeTransform:(struct CGAffineTransform)arg2;
- (unsigned long long)_renderStrokes:(id)arg1 clippedToStrokeSpaceRect:(struct CGRect)arg2 strokeTransform:(struct CGAffineTransform)arg3 stopBlock:(CDUnknownBlockType)arg4;
- (void)disableClippingForRenderEncoder:(id)arg1;
- (void)setupRenderStateForRenderingStrokes:(id)arg1;
- (void)teardownRenderStateIfNecessary;
- (void)setupDrawingFramebuffersIfNecessaryLiveRendering:(_Bool)arg1;
- (id)renderCommandEncoderForCommandBuffer:(id)arg1 backBufferLoadAction:(unsigned long long)arg2 backBufferStoreAction:(unsigned long long)arg3 paintBufferLoadAction:(unsigned long long)arg4 accumulatorBufferLoadAction:(unsigned long long)arg5 accumulatorBufferStoreAction:(unsigned long long)arg6 destinationLoadAction:(unsigned long long)arg7;
- (void)setupRenderStateForStrokeRenderingNeedPaintBuffer:(_Bool)arg1 needRenderMask:(_Bool)arg2;
- (_Bool)shouldAccumulateLiveStroke;
- (void)setupRenderStateForLiveRenderingDestinationTexture:(id)arg1 destinationLoadAction:(unsigned long long)arg2 accumLoadAction:(unsigned long long)arg3 accumStoreAction:(unsigned long long)arg4 backBufferLoadAction:(unsigned long long)arg5 backBufferStoreAction:(unsigned long long)arg6;
- (void)resetPaintFramebufferAccumulate:(_Bool)arg1;
- (void)renderAnimatingStrokesWithTransform:(struct CGAffineTransform)arg1 renderBufferSize:(struct CGSize)arg2;
- (void)renderWithTransform:(struct CGAffineTransform)arg1 animatingStroke:(struct AnimatingStroke *)arg2 mode:(long long)arg3 clipped:(_Bool)arg4 renderBufferSize:(struct CGSize)arg5 renderEncoder:(id)arg6;
- (void)purgePaintFramebuffers;
- (void)finishRenderingClippedToStrokeSpaceRect:(struct CGRect)arg1 forStroke:(struct AnimatingStroke *)arg2 renderEncoder:(id)arg3;
- (void)finishStroke;
- (void)renderFullscreenQuadWithShader:(id)arg1 renderEncoder:(id)arg2;
- (void)renderStroke:(id)arg1 withTransform:(struct CGAffineTransform)arg2 mode:(long long)arg3 flipped:(_Bool)arg4 renderBufferSize:(struct CGSize)arg5 renderEncoder:(id)arg6 currentClipRect:(struct CGRect)arg7 needRenderMask:(_Bool)arg8;
- (void)copyFromFramebuffer:(id)arg1 toFramebuffer:(id)arg2 clipRect:(struct CGRect)arg3 renderEncoder:(id)arg4;
- (void)setupForDefaultUberVertexShaderInRenderEncoder:(id)arg1;
- (void)renderTexture:(id)arg1 intoFramebuffer:(id)arg2 sourceRect:(struct CGRect)arg3 destinationRect:(struct CGRect)arg4 renderState:(id)arg5;
- (void)renderTexture:(id)arg1 intoFramebuffer:(id)arg2 sourceRect:(struct CGRect)arg3 destinationPosition:(struct CGPoint)arg4 renderState:(id)arg5;
- (_Bool)ensureOriginalBackFramebufferHasContents;
- (struct CGImage *)newCGImageFromTexture:(id)arg1 clipRect:(struct CGRect)arg2 copyImage:(_Bool)arg3;
- (struct CGImage *)newCGImageWithClipRect:(struct CGRect)arg1 copyImage:(_Bool)arg2;
- (void)setupUberVertexShaderWithTransform:(struct CGAffineTransform)arg1 paperTransform:(struct CGAffineTransform)arg2 renderEncoder:(id)arg3;
- (struct CGAffineTransform)strokeRenderTransformForFramebufferSize:(struct CGSize)arg1 flipped:(_Bool)arg2;
- (void)setupOriginalBackFramebufferIfNecessary;
- (void)setupCachedResourcesIfNecessary;
- (void)renderEraserIndicator:(struct _PKStrokePoint)arg1 withTransform:(struct CGAffineTransform)arg2;
- (void)finishRenderingNoTeardownForStroke:(struct AnimatingStroke *)arg1 clippedToPixelSpaceRect:(struct CGRect)arg2 renderEncoder:(id)arg3;
- (void)finishRendering;
- (_Bool)setupClippingForStrokeClipRect:(struct CGRect)arg1 clippedToPixelSpaceRect:(struct CGRect)arg2 renderEncoder:(id)arg3 outNewClipRect:(struct CGRect *)arg4;
- (void)clearPaintFramebuffersWithRenderEncoder:(id)arg1;
- (void)setPaperTextureOnRenderEncoder:(id)arg1 fragmentUniforms:(struct PKMetalUberFragmentUniforms *)arg2;
- (void)renderPaperTransform:(struct CGAffineTransform)arg1 paperTransform:(struct CGAffineTransform)arg2 flipped:(_Bool)arg3 multiply:(double)arg4 renderEncoder:(id)arg5;
- (void)renderLinesRenderBufferSize:(struct CGSize)arg1 renderEncoder:(id)arg2;
- (void)renderBrushIndicatorForStroke:(id)arg1 withTransform:(struct CGAffineTransform)arg2 mode:(long long)arg3;
- (void)setupRenderEncoder:(id)arg1 forParticleStroke:(struct AnimatingStroke *)arg2;
- (void)setupRenderEncoder:(id)arg1 forPenStroke:(struct AnimatingStroke *)arg2;
- (unsigned long long)renderPaintRenderCache:(id)arg1 renderEncoder:(id)arg2 computeEncoder:(id)arg3 animatingStroke:(struct AnimatingStroke *)arg4;
- (unsigned long long)renderLiveStrokePaintRenderCache:(id)arg1 renderEncoder:(id)arg2 computeEncoder:(id)arg3 animatingStroke:(struct AnimatingStroke *)arg4;
- (unsigned long long)renderStrokeRenderCache:(id)arg1 renderEncoder:(id)arg2 animatingStroke:(struct AnimatingStroke *)arg3 indexed:(_Bool)arg4;
- (unsigned long long)renderPenStroke:(struct _PKStrokePointSlice)arg1 animatingStroke:(struct AnimatingStroke *)arg2 combinedRendering:(_Bool)arg3 renderEncoder:(id)arg4;
- (unsigned long long)renderParticleRenderCache:(id)arg1 renderEncoder:(id)arg2 computeEncoder:(id)arg3 animatingStroke:(struct AnimatingStroke *)arg4;
- (unsigned long long)renderParticleStroke:(struct _PKStrokePointSlice)arg1 animatingStroke:(struct AnimatingStroke *)arg2 starts:(_Bool)arg3 ends:(_Bool)arg4 combinedRendering:(_Bool)arg5 renderEncoder:(id)arg6;
- (void)setVertexBuffersForVertices:(const struct StrokeVertex *)arg1 numVertices:(unsigned long long)arg2 renderEncoder:(id)arg3;
- (struct CGAffineTransform)strokeRenderTransform;
- (void)setupStrokeBufferIfNecessary;
- (void)renderStrokeVertices:(const struct StrokeVertex *)arg1 numVertices:(unsigned long long)arg2 numIndices:(unsigned long long)arg3 renderEncoder:(id)arg4;
- (struct CGRect)clipRectForVertices:(const struct StrokeVertex *)arg1 numVertices:(unsigned long long)arg2;
- (void)addBufferForRenderCache:(id)arg1 strokeVertices:(struct StrokeVertex *)arg2 numVertices:(unsigned long long)arg3;
- (unsigned long long)renderVerticies:(struct StrokeVertex *)arg1 size:(unsigned long long)arg2 numRenderedVertices:(unsigned long long)arg3 numIndices:(unsigned long long)arg4 localClipRect:(struct CGRect)arg5 animatingStroke:(struct AnimatingStroke *)arg6 combinedRendering:(_Bool)arg7 renderEncoder:(id)arg8;
- (id)dummyPaintFramebuffer;
- (id)dummyColorFramebuffer;
- (_Bool)generateBSplineInComputeForStroke:(id)arg1;
- (id)generateCacheForStroke:(struct AnimatingStroke *)arg1 points:(struct _PKStrokePointSlice)arg2 segmentSteps:(const vector_3203cf93 *)arg3;
- (void)setupRenderState:(id)arg1 needCompute:(_Bool)arg2 clearPaint:(_Bool)arg3;
- (id)cacheForMask:(id)arg1 strokeRenderCache:(id)arg2 purgeableResources:(id)arg3;
- (id)renderCacheItemForStroke:(struct AnimatingStroke *)arg1 bsplineFilter:(struct PKBSplineFilter *)arg2 purgeableResources:(id)arg3 strokeRenderCache:(id)arg4;
- (void)setupRenderState:(id)arg1 needCompute:(_Bool)arg2;
- (_Bool)canRenderStroke:(id)arg1 combinedWith:(id)arg2;
- (void)clearNowWithStrokeSpaceClipRect:(struct CGRect)arg1 strokeTransform:(struct CGAffineTransform)arg2;
- (id)generatePaintCacheForStroke:(struct _PKStrokePointSlice)arg1 animatingStroke:(struct AnimatingStroke *)arg2 segmentSteps:(const vector_3203cf93 *)arg3 liveStrokePoints:(const MISSING_TYPE **)arg4 liveStrokeStartTime:(float)arg5 strokeInterval:(float)arg6;
- (id)generateCacheForPenStroke:(struct AnimatingStroke *)arg1 points:(struct _PKStrokePointSlice)arg2;
- (id)generateCacheForParticleStroke:(struct AnimatingStroke *)arg1 points:(struct _PKStrokePointSlice)arg2 startPt:(_Bool)arg3 endPt:(_Bool)arg4;
- (id)generateParticleCacheForStroke:(struct _PKStrokePointSlice)arg1 animatingStroke:(struct AnimatingStroke *)arg2 starts:(_Bool)arg3 ends:(_Bool)arg4;
- (id)generateCacheForMask:(id)arg1;
- (void)renderMaskForStroke:(id)arg1 renderCache:(id)arg2;
- (id)framebufferForTile:(id)arg1 createIfNeeded:(_Bool)arg2;
- (void)clearFramebuffer:(id)arg1 waitUntilCompleted:(_Bool)arg2;
- (void)renderTexture:(id)arg1 intoFramebuffer:(id)arg2 clipRect:(struct CGRect)arg3 renderState:(id)arg4;
- (void)renderTile:(id)arg1 tileTransform:(struct CGAffineTransform)arg2 renderState:(id)arg3;
- (void)renderImage:(struct CGImage *)arg1 intoFramebuffer:(id)arg2 clipRect:(struct CGRect)arg3;
- (void)cancelLiveStroke;
- (unsigned long long)colorAttachmentIndexFromFramebuffer:(id)arg1;
- (void)copyIntoPaintFromTexture:(id)arg1 clipRect:(struct CGRect)arg2 renderEncoder:(id)arg3;
- (void)debugFramebuffers;

@end
